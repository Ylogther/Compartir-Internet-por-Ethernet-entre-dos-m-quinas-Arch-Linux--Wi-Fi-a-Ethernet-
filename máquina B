#!/usr/bin/env bash
# ------------------------------------------------------------------
#  lan-client.sh
#  Configura IP estática, gateway y DNS para salir a Internet
# ------------------------------------------------------------------
set -euo pipefail

# === Ajusta solo estas tres líneas =================================
IFACE_LAN="enp3s0"      # interfaz ethernet hacia Máquina A
CLIENT_IP="10.0.0.2"    # IP de este PC
GATEWAY="10.0.0.1"      # IP de Máquina A
# ===================================================================

echo "[*] Configurando IP $CLIENT_IP/24 en $IFACE_LAN..."
ip addr add "$CLIENT_IP/24" dev "$IFACE_LAN" || true
ip link set "$IFACE_LAN" up

echo "[*] Estableciendo puerta de enlace por defecto..."
ip route replace default via "$GATEWAY" dev "$IFACE_LAN"

echo "[*] Configurando DNS Cloudflare..."
resolvectl dns "$IFACE_LAN" 1.1.1.1
resolvectl domain "$IFACE_LAN" "~."

echo "✔ Conexión lista. Prueba con:  ping -c3 archlinux.org"
